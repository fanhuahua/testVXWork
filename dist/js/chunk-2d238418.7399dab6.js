(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d238418"],{ff35:function(e,t,a){"use strict";a.r(t);var o=a("f3f3"),n=a("7a23"),s=Object(n["withScopeId"])("data-v-00e872d6");Object(n["pushScopeId"])("data-v-00e872d6");var l={style:{display:"flex","justify-content":"center"}},r=Object(n["createTextVNode"])(" 销 假");Object(n["popScopeId"])();var c=s((function(e,t,a,c,d,j){var u=Object(n["resolveComponent"])("student-info-cell"),i=Object(n["resolveComponent"])("s-picker"),m=Object(n["resolveComponent"])("s-datetime-picker"),b=Object(n["resolveComponent"])("van-field"),f=Object(n["resolveComponent"])("s-uploader"),p=Object(n["resolveComponent"])("van-form"),q=Object(n["resolveComponent"])("van-cell-group"),v=Object(n["resolveComponent"])("ApprovalCommon"),O=Object(n["resolveComponent"])("van-button"),x=Object(n["resolveComponent"])("van-popover");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],null,[Object(n["createVNode"])(v,Object(n["mergeProps"])(c.state,{"choose-params":{qjtslx:c.state.qjtslx},"type-name":"学生请假申请",applyInfo:Object(o["a"])({},c.state),"before-submit-validate":c.onValidate,onSubmit:c.onSubmit,class:"pd-0",style:{"padding-bottom":"0px"}}),{default:s((function(){return[Object(n["createVNode"])(u,{"student-info":c.state,"onUpdate:student-info":t[1]||(t[1]=function(e){return c.state=e}),ref:"studentInfo"},null,8,["student-info"]),Object(n["createVNode"])(q,{inset:""},{default:s((function(){return[Object(n["createVNode"])(p,{ref:"formRef","scroll-to-error":"",disabled:c.disabled},{default:s((function(){return[Object(n["createVNode"])(i,{name:"qjlx",label:"请假类型",modelValue:c.state.qjlx,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.state.qjlx=e}),"dict-name":"xg_qjsx_qjlx",rules:[{required:!0,message:"请选择"}],"columns-field-names":{text:"dictLabel",setValue:"dictValue"}},null,8,["modelValue"]),Object(n["createVNode"])(m,{name:"qjkssj",label:"开始时间",type:"datetime",modelValue:c.state.qjkssj,"onUpdate:modelValue":t[3]||(t[3]=function(e){return c.state.qjkssj=e}),"value-format":c.valueFormat,"min-date":c.startDateRange.minDate,"max-date":c.startDateRange.maxDate,rules:[{required:!0,message:"请选择"},c.validator.startRule]},null,8,["modelValue","value-format","min-date","max-date","rules"]),Object(n["createVNode"])(m,{name:"qjjssj",label:"结束时间",type:"datetime",modelValue:c.state.qjjssj,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.state.qjjssj=e}),"value-format":c.valueFormat,"min-date":c.endDateRange.minDate,"max-date":c.endDateRange.maxDate,rules:[{required:!0,message:"请选择"},c.validator.endRule]},null,8,["modelValue","value-format","min-date","max-date","rules"]),Object(n["createVNode"])(i,{name:"qjtslx",label:"请假天数",modelValue:c.state.qjtslx,"onUpdate:modelValue":t[5]||(t[5]=function(e){return c.state.qjtslx=e}),"dict-name":"xg_qjsx_qjtslx",disabled:"",rules:[{required:!1,message:"自动计算"}],"columns-field-names":{text:"dictLabel",setValue:"dictValue"}},null,8,["modelValue"]),Object(n["createVNode"])(b,{name:"qjyy",label:"请假原因",maxlength:200,autosize:"",rows:1,type:"textarea","show-word-limit":"",modelValue:c.state.qjyy,"onUpdate:modelValue":t[6]||(t[6]=function(e){return c.state.qjyy=e}),placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入"}]},null,8,["modelValue"]),Object(n["createVNode"])(b,{name:"qx",label:"去向",maxlength:100,"show-word-limit":"",autosize:"",rows:1,type:"textarea",modelValue:c.state.qx,"onUpdate:modelValue":t[7]||(t[7]=function(e){return c.state.qx=e}),placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入"}]},null,8,["modelValue"]),Object(n["createVNode"])(b,{name:"uploader",label:"文件上传"},{input:s((function(){return[Object(n["createVNode"])(f,{modelValue:c.state.fj,"onUpdate:modelValue":t[8]||(t[8]=function(e){return c.state.fj=e}),disabled:c.disabled},null,8,["modelValue","disabled"])]})),_:1})]})),_:1},8,["disabled"])]})),_:1})]})),_:1},16,["choose-params","applyInfo","before-submit-validate","onSubmit"]),Object(n["createVNode"])("div",l,[Object(n["createVNode"])(x,{show:c.state.showPopover,"onUpdate:show":t[9]||(t[9]=function(e){return c.state.showPopover=e}),actions:c.actions,onSelect:c.onSelect,placement:"top"},{reference:s((function(){return["审批通过"!==c.state.taskName||c.state.xjsj||c.isStudent?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(O,{key:0,style:{width:"150px"},round:"",type:"danger"},{default:s((function(){return[r]})),_:1}))]})),_:1},8,["show","actions","onSelect"])])],64)})),d=(a("9a83"),a("f564")),j=(a("d82d"),a("7278")),u=(a("99af"),a("caad"),a("450a")),i=a("3631"),m=a("f602"),b=a("135f"),f=a("bade"),p=a("bd56"),q=a("ca00"),v=a("6c02"),O=a("9670b"),x=a("5a0c"),V=a.n(x),k=a("c405"),D=a("4a89"),y={name:"askForLeave",components:{StudentInfoCell:D["a"],SDatetimePicker:O["a"],ApprovalCommon:b["a"],SUploader:m["a"],SPicker:i["a"],vanPopover:j["a"]},setup:function(){var e="YYYY-MM-DD  HH:mm",t=new Date(2018,1,1),a=V()().add(10,"year").toDate(),s=new Date,l=Object(n["reactive"])({minDate:t,maxDate:a}),r=Object(n["reactive"])({minDate:t,maxDate:a}),c=Object(n["reactive"])({authority:{canEdit:!0},id:0,qjkssj:void 0,qjjssj:void 0,showPopover:!1}),j=[{text:"确认销假?"},{text:"取消"}],i=Object(f["c"])(["xg_xs"]),m=Object(n["ref"])(!1),b=Object(n["ref"])(null),O=Object(n["ref"])(null),x=Object(v["d"])(),D=Object(u["a"])(c),y=D.resetFields,h=D.setFieldValue,g=Object(n["toRefs"])(c),w=g.qjkssj,S=g.qjjssj,N=Object(k["a"])(w,S),C=Object(v["c"])(),_=C.query;_.id&&Object(p["d"])(_.id,"获取详情").then((function(e){var t,a;0===e.code&&(Object.assign(c,Object(q["i"])(e.data)),m.value=!(null!==(t=c.authority)&&void 0!==t&&t.canEdit),null!==(a=c.authority)&&void 0!==a&&a.canApproval&&(m.value=!1),c.qjkssj&&c.ksqjjs&&(w.value="".concat(c.qjkssj," ").concat(c.ksqjjs)),c.qjjssj&&c.jsqjjs&&(S.value="".concat(c.qjjssj," ").concat(c.jsqjjs)))})),Object(n["watch"])((function(){return c.qjlx}),(function(e){["1","2"].includes(e)?(l.minDate=r.minDate=s,l.maxDate=r.maxDate=a):["3","4"].includes(e)?(l.minDate=r.minDate=t,l.maxDate=r.maxDate=s):y(["qjkssj","qjjssj","qjtslx"])})),Object(n["watchEffect"])((function(){if(c.qjkssj&&c.qjjssj&&V()(c.qjkssj).isSameOrBefore(c.qjjssj)){var e=V()(c.qjjssj);V()(c.qjkssj).isBefore(e.subtract(7,"day"))?h("qjtslx","3"):V()(c.qjkssj).isSameOrAfter(e.subtract(2,"day"))?h("qjtslx","1"):h("qjtslx","2")}else h("qjtslx",void 0)}));var Y=function(e){Object(p["f"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},e),c),{},{qjkssj:V()(c.qjkssj).format("YYYY-MM-DD"),ksqjjs:V()(c.qjkssj).format("HH:mm"),qjjssj:V()(c.qjjssj).format("YYYY-MM-DD"),jsqjjs:V()(c.qjjssj).format("HH:mm")}),"提交中").then((function(e){0===e.code&&(Object(d["a"])({type:"success",message:"提交成功",duration:1e3}),x.back())}))},R=function(){var e;return null===(e=b.value)||void 0===e?void 0:e.validate()},U=function(e){"取消"!=e.text&&Object(p["e"])(c.id,"正在销假").then((function(e){0===e.code&&(Object(d["a"])({type:"success",message:"销假成功",duration:1e3}),x.back())}))};return{actions:j,onSelect:U,validator:N,state:c,valueFormat:e,formRef:b,disabled:m,studentInfo:O,onSubmit:Y,onValidate:R,startDateRange:l,endDateRange:r,isStudent:i}}};y.render=c,y.__scopeId="data-v-00e872d6";t["default"]=y}}]);