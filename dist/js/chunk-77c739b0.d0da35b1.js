(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77c739b0"],{"0666":function(e,t,n){"use strict";n("aa70")},1101:function(e,t,n){},"135f":function(e,t,n){"use strict";var o=n("7a23"),a=Object(o["withScopeId"])("data-v-df3a2d14");Object(o["pushScopeId"])("data-v-df3a2d14");var c={class:"approval-common"},r=Object(o["createVNode"])("div",{class:"approval-head"},null,-1),i={class:"approval-content"},s={class:"approval-foot"};Object(o["popScopeId"])();var l=a((function(e,t,n,l,d,u){var b=Object(o["resolveComponent"])("approval-process"),p=Object(o["resolveComponent"])("van-action-bar-icon"),m=Object(o["resolveComponent"])("van-button"),f=Object(o["resolveComponent"])("approval-buttons"),j=Object(o["resolveComponent"])("van-action-bar"),O=Object(o["resolveComponent"])("approval-modal");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])("div",c,[r,Object(o["createVNode"])("div",i,[Object(o["renderSlot"])(e.$slots,"default",{},void 0,!0)]),Object(o["createVNode"])("div",s,[n.isWorkFlow?(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:0,style:{"margin-bottom":"10px"},processInstanceId:n.processInstanceId},null,8,["processInstanceId"])):Object(o["createCommentVNode"])("",!0),l.visible?(Object(o["openBlock"])(),Object(o["createBlock"])(j,{key:1},{default:a((function(){return[Object(o["createVNode"])(p,{class:{disabledIcon:n.btnLoading},icon:"arrow-left",text:"返回",loading:n.btnLoading,onClick:t[1]||(t[1]=function(e){return!n.btnLoading&&l.back()})},null,8,["class","loading"]),Object(o["createVNode"])(f,{authority:n.authority},{edit:a((function(){return[Object(o["createVNode"])(m,{block:"",round:"",type:"primary",text:"保存",loading:n.btnLoading,onClick:t[2]||(t[2]=function(e){return l.handleOk(0)})},null,8,["loading"])]})),submit:a((function(){return[n.isWorkFlow?(Object(o["openBlock"])(),Object(o["createBlock"])(m,{key:0,style:{"margin-left":"6px","margin-right":"6px"},block:"",round:"",type:"primary",text:"提交",loading:n.btnLoading,onClick:t[3]||(t[3]=function(e){return l.handleOk(9)})},null,8,["loading"])):Object(o["createCommentVNode"])("",!0)]})),che:a((function(){return[n.isWorkFlow?(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:0,class:{disabledIcon:n.btnLoading},icon:"revoke",text:"撤回",onClick:t[4]||(t[4]=function(e){return!n.btnLoading&&l.handleOk(3)})},null,8,["class"])):Object(o["createCommentVNode"])("",!0)]})),tui:a((function(){return[n.isWorkFlow?(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:0,class:{disabledIcon:n.btnLoading},icon:"down",text:"退回",onClick:t[5]||(t[5]=function(e){return!n.btnLoading&&l.handleOk(4)})},null,8,["class"])):Object(o["createCommentVNode"])("",!0)]})),reject:a((function(){return[n.isWorkFlow?(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:0,class:{disabledIcon:n.btnLoading},icon:"failure",text:"拒绝",onClick:t[6]||(t[6]=function(e){return!n.btnLoading&&l.handleOk(2)})},null,8,["class"])):Object(o["createCommentVNode"])("",!0)]})),agree:a((function(){return[n.isWorkFlow?(Object(o["openBlock"])(),Object(o["createBlock"])(m,{key:0,block:"",round:"",type:"primary",style:{"margin-right":"6px"},text:"同意",loading:n.btnLoading,onClick:t[7]||(t[7]=function(e){return l.handleOk(1)})},null,8,["loading"])):Object(o["createCommentVNode"])("",!0)]})),_:1},8,["authority"])]})),_:1})):Object(o["createCommentVNode"])("",!0)])]),n.isWorkFlow?(Object(o["openBlock"])(),Object(o["createBlock"])(O,{key:0,ref:"approvalRef","type-name":n.typeName,processInstanceId:n.processInstanceId,chooseParams:n.chooseParams,taskId:n.taskId,params:n.params,"proc-def-key":n.procDefKey},null,8,["type-name","processInstanceId","chooseParams","taskId","params","proc-def-key"])):Object(o["createCommentVNode"])("",!0)],64)})),d=n("c964"),u=n("fc11"),b=(n("7279"),n("a792")),p=(n("71ba"),n("a3f9")),m=(n("21f7"),n("d3d4")),f=(n("96cf"),n("b0c0"),n("a9e3"),n("d3b7"),Object(o["withScopeId"])("data-v-548f9a9a"));Object(o["pushScopeId"])("data-v-548f9a9a");var j={key:0,class:"tipWrap"},O={key:1,class:"tipWrap"},v={key:2},h={class:"btns"},k=Object(o["createTextVNode"])(" 取消 "),y=Object(o["createTextVNode"])(" 确定 ");Object(o["popScopeId"])();var g=f((function(e,t,n,a,c,r){var i=Object(o["resolveComponent"])("tuihui"),s=Object(o["resolveComponent"])("xzsplc"),l=Object(o["resolveComponent"])("van-field"),d=Object(o["resolveComponent"])("xygspr"),u=Object(o["resolveComponent"])("xygsprMult"),b=Object(o["resolveComponent"])("van-form"),p=Object(o["resolveComponent"])("van-button"),m=Object(o["resolveComponent"])("s-loading"),g=Object(o["resolveComponent"])("van-popup");return Object(o["openBlock"])(),Object(o["createBlock"])(g,{show:e.visible,"onUpdate:show":t[3]||(t[3]=function(t){return e.visible=t}),position:"bottom"},{default:f((function(){return[Object(o["createVNode"])(m,{loading:e.$wait.is("chooseAssignee")},{default:f((function(){return[3===e.action?(Object(o["openBlock"])(),Object(o["createBlock"])("div",j,"是否确认撤回该流程?")):0===e.action&&n.processInstanceId?(Object(o["openBlock"])(),Object(o["createBlock"])("div",O," 是否保存该数据? ")):(Object(o["openBlock"])(),Object(o["createBlock"])("div",v,[e.visible?(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:0,ref:"formRef",onSubmit:a.onSubmit},{default:f((function(){return[4===e.action?(Object(o["openBlock"])(),Object(o["createBlock"])(i,{key:0,rejectTaskList:e.rejectTaskList,ref:function(t){return e.refData.tuihui=t},processInstanceId:n.processInstanceId},null,8,["rejectTaskList","processInstanceId"])):Object(o["createCommentVNode"])("",!0),e.validatedForm.id?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(s,{key:1,proList:e.proList,ref:function(t){return e.refData.xzsplc=t}},null,8,["proList"])),4!==e.action&&2!==e.action?(Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:2,name:"xygspjd",label:"下一节点",modelValue:e.nextName,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.nextName=t}),disabled:"",placeholder:"请输入"},null,8,["modelValue"])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createVNode"])(d,{required:r.showNext,assigneeList:e.assigneeList,ref:function(t){return e.refData.xygspr=t}},null,8,["required","assigneeList"]),[[o["vShow"],r.showNext]]),r.showNextMul?(Object(o["openBlock"])(),Object(o["createBlock"])(u,{key:3,required:r.showNextMul,assigneeList:e.assigneeList,ref:function(t){return e.refData.xygsprMult=t}},null,8,["required","assigneeList"])):Object(o["createCommentVNode"])("",!0),n.processInstanceId&&1===e.action||2===e.action||4===e.action?(Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:4,required:"",modelValue:e.comment,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.comment=t}),rows:"2",autosize:"",name:"comment",label:"审批意见",type:"textarea",placeholder:"请输入",maxlength:"200","show-word-limit":"",rules:[{required:!0,message:"请选择"}]},null,8,["modelValue"])):Object(o["createCommentVNode"])("",!0)]})),_:1},8,["onSubmit"])):Object(o["createCommentVNode"])("",!0)])),Object(o["createVNode"])("div",h,[Object(o["createVNode"])(p,{class:"bottomBtn",round:"",onClick:r.handleRest},{default:f((function(){return[k]})),_:1},8,["onClick"]),Object(o["createVNode"])(p,{loading:e.$wait.is("saveJSSYSQ"),class:"bottomBtn",round:"",type:"primary",onClick:a.handlSubmit},{default:f((function(){return[y]})),_:1},8,["loading","onClick"])])]})),_:1},8,["loading"])]})),_:1},8,["show"])})),N=n("f3f3"),I=(n("caad"),n("2532"),n("ac1f"),n("1276"),n("b64b"),n("159b"),n("eab0")),C=n("7ff9"),w=n("6ff2"),V=n("8491"),x=n("2934"),S=n("c5e6"),L={name:"ApprovalModal",components:{tuihui:I["a"],xzsplc:C["a"],xygspr:w["a"],xygsprMult:V["a"],SLoading:S["a"]},setup:function(e,t){var n=Object(o["ref"])(null),a=Object(o["reactive"])({comment:"",visible:!1,refData:{},validatedForm:{},action:0,myPromise:void 0,proList:[],rejectTaskList:[],assigneeList:[],multiInstance:!1,nextName:void 0}),c=function(e){return"string"===typeof e?e.includes(",")?[e]:e.split(","):e},r=function(t){var n,o,r,i=t&&t.assigneeList?c(t.assigneeList):[];a.myPromise&&a.myPromise.resolve(Object(N["a"])(Object(N["a"])({},a.validatedForm),{},{processParam:Object(N["a"])(Object(N["a"])({},t),{},{assigneeList:i,id:null===(n=a.validatedForm)||void 0===n?void 0:n.id,processInstanceId:a.processInstanceId||(null===(o=a.validatedForm)||void 0===o?void 0:o.processInstanceId)||e.processInstanceId,taskId:a.taskId||(null===(r=a.validatedForm)||void 0===r?void 0:r.taskId)||e.taskId,action:a.action,variables:a.chooseParams||e.chooseParams})}))},i=function(){3===a.action||0===a.action&&e.processInstanceId?r():n.value.submit()},s=function(e){r(e)},l=function(){a.visible=!0},d=function(){a.visible=!1},u=function(){var e=Object.keys(a.refData);e.length>0&&e.forEach((function(e){var t;null===(t=a.refData[e])||void 0===t||t.restData()})),a.visible=!1};return Object(N["a"])(Object(N["a"])({},Object(o["toRefs"])(a)),{},{formRef:n,onSubmit:s,showPopup:l,handleCancle:d,resetForm:u,handlSubmit:i})},data:function(){return{}},created:function(){},computed:{showNext:function(){return(1===this.action||9===this.action)&&"结束"!==this.nextName&&!this.multiInstance},showNextMul:function(){return(1===this.action||9===this.action)&&"结束"!==this.nextName&&this.multiInstance}},props:{typeName:{type:String,required:!0},procDefKey:{type:[String,Number],default:void 0},processInstanceId:{type:[String,Number],default:void 0},taskId:{type:[String,Number],default:void 0},params:{type:Object,default:function(){return{}}},chooseParams:{type:Object,default:function(){return{}}}},watch:{visible:function(e){var t=this;e&&(this.validatedForm.id?4===this.action?this.getRejectList():1!==this.action&&9!==this.action||this.getNextList():this.procDefKey?this.getNextList():Object(x["j"])(Object(N["a"])({typeName:this.typeName},this.params)).then((function(e){t.proList=e.data,1===e.data.length&&t.getNextList(e.data[0].key)})))}},methods:{handleOk:function(){this.$refs.form.submit()},handleRest:function(){this.resetForm()},getNextList:function(e){var t=this;Object(x["c"])(Object(N["a"])(Object(N["a"])({processInstanceId:this.processInstanceId,procDefKey:e||this.procDefKey,skip:1},this.chooseParams),{},{formData:this.validatedForm.applyInfo})).then((function(e){var n=e.data,o=n.multiInstance,a=n.assigneeList,c=n.name;t.assigneeList=a,t.multiInstance=o,t.nextName=c}))},getRejectList:function(){var e=this;Object(x["l"])({processInstanceId:this.processInstanceId}).then((function(t){e.rejectTaskList=t.data}))},startApproval:function(e,t){var n=this;return 1==t&&(this.comment="同意"),this.validatedForm=e,this.action=t,this.visible=!0,new Promise((function(e,t){n.myPromise={resolve:e,reject:t}}))}}};n("0666");L.render=g,L.__scopeId="data-v-548f9a9a";var B=L,D=Object(o["createVNode"])("div",{style:{margin:"12px","font-size":"16px"}},"审批流程",-1),F={style:{padding:"0 10px"}},_={style:{color:"rgba(0, 0, 0, 0.85)"}},P={style:{color:"rgba(0, 0, 0, 0.45)"}},A={style:{color:"rgba(18, 28, 37, 0.65)"}},T={style:{color:"rgba(18, 28, 37, 0.45)","text-align":"right"}};function R(e,t,n,a,c,r){var i=Object(o["resolveComponent"])("van-col"),s=Object(o["resolveComponent"])("van-row"),l=Object(o["resolveComponent"])("van-step"),d=Object(o["resolveComponent"])("van-steps"),u=Object(o["resolveComponent"])("van-empty"),b=Object(o["resolveComponent"])("van-cell-group");return Object(o["openBlock"])(),Object(o["createBlock"])(b,{inset:""},{default:Object(o["withCtx"])((function(){return[D,Object(o["withDirectives"])(Object(o["createVNode"])(d,{direction:"vertical"},{default:Object(o["withCtx"])((function(){return[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(c.timeLineData,(function(e,t){return Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:t},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(s,{type:"flex"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(i,{span:16},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("div",F,[Object(o["createVNode"])("div",_,Object(o["toDisplayString"])(e.taskName),1),Object(o["createVNode"])("div",P,Object(o["toDisplayString"])(e.auditNickName)+"（"+Object(o["toDisplayString"])(e.auditTypeName)+"） ",1),Object(o["createVNode"])("div",A,Object(o["toDisplayString"])(e.auditNote&&"审批意见:".concat(e.auditNote)),1)])]})),_:2},1024),Object(o["createVNode"])(i,{span:8},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("div",T,Object(o["toDisplayString"])(e.auditTime),1)]})),_:2},1024)]})),_:2},1024)]})),_:2},1024)})),128)),Object(o["createVNode"])(l,null,{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(" 当前节点："+Object(o["toDisplayString"])(c.currentName),1)]})),_:1})]})),_:1},512),[[o["vShow"],c.timeLineData.length]]),Object(o["withDirectives"])(Object(o["createVNode"])(u,null,null,512),[[o["vShow"],!c.timeLineData.length]])]})),_:1})}n("91d5");var W,$=n("f0ca"),q=(n("1f87"),n("510b")),M=(n("77f8"),n("dc0f")),K={name:"ApprovalProcess",props:{processInstanceId:{type:[String,Number],default:void 0}},data:function(){return{timeLineData:[],currentName:void 0}},components:(W={},Object(u["a"])(W,M["a"].name,M["a"]),Object(u["a"])(W,q["a"].name,q["a"]),Object(u["a"])(W,$["a"].name,$["a"]),W),watch:{processInstanceId:{immediate:!0,handler:function(e){e?this.getViewTask(e):(this.timeLineData=[],this.currentName=void 0)}}},created:function(){},methods:{getViewTask:function(e){var t=this;Object(x["o"])({processInstanceId:e}).then((function(e){e.data.length>1?(t.timeLineData=e.data,t.currentName=t.timeLineData.pop().taskName):(t.timeLineData=[],t.currentName=!1)}))}}};K.render=R;var U=K,z=Object(o["withScopeId"])("data-v-39aef98e"),E=z((function(e,t,n,a,c,r){return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["renderSlot"])(e.$slots,"cancel",{},void 0,!0),n.authority&&n.authority.canEdit?Object(o["renderSlot"])(e.$slots,"edit",{key:0},void 0,!0):Object(o["createCommentVNode"])("",!0),n.authority&&n.authority.canEdit?Object(o["renderSlot"])(e.$slots,"submit",{key:1},void 0,!0):Object(o["createCommentVNode"])("",!0),n.authority&&n.authority.canChe?Object(o["renderSlot"])(e.$slots,"che",{key:2},void 0,!0):Object(o["createCommentVNode"])("",!0),n.authority&&n.authority.canTui?Object(o["renderSlot"])(e.$slots,"tui",{key:3},void 0,!0):Object(o["createCommentVNode"])("",!0),n.authority&&n.authority.canApproval?Object(o["renderSlot"])(e.$slots,"reject",{key:4},void 0,!0):Object(o["createCommentVNode"])("",!0),n.authority&&n.authority.canApproval?Object(o["renderSlot"])(e.$slots,"agree",{key:5},void 0,!0):Object(o["createCommentVNode"])("",!0),n.authority&&n.authority.canAgain?Object(o["renderSlot"])(e.$slots,"again",{key:6},void 0,!0):Object(o["createCommentVNode"])("",!0)],64)})),J={name:"ApprovalButtons",props:{authority:{type:Object,default:function(){return{}}}}};n("9c53");J.render=E,J.__scopeId="data-v-39aef98e";var Q,Y=J,G=n("ca00"),H=n("6c02"),X={name:"ApprovalCommon",components:(Q={ApprovalButtons:Y,ApprovalProcess:U,ApprovalModal:B},Object(u["a"])(Q,m["b"].name,m["b"]),Object(u["a"])(Q,p["a"].name,p["a"]),Object(u["a"])(Q,b["b"].name,b["b"]),Q),props:{btnLoading:Boolean,id:Number,chooseParams:Object,applyInfo:Object,params:Object,authority:{type:Object,default:function(){return{canEdit:!1,canChe:!1,canTui:!1,canApproval:!1}}},typeName:{type:String,default:""},procDefKey:{type:[String,Number],default:void 0},processInstanceId:{type:[String,Number],default:void 0},taskId:{type:[String,Number],default:void 0},taskName:{type:String,default:""},beforeSubmitValidate:[Function,Promise],isWorkFlow:{type:Boolean,default:!0}},emits:["submit","cancel"],setup:function(e,t){var n,a=Object(o["ref"])(null),c=function(){var o=Object(d["a"])(regeneratorRuntime.mark((function o(c){var r,i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(o.prev=0,o.t0=e.beforeSubmitValidate,!o.t0){o.next=6;break}return o.next=5,e.beforeSubmitValidate();case 5:n=o.sent;case 6:o.next=11;break;case 8:o.prev=8,o.t1=o["catch"](0),n="error";case 11:if(!n){o.next=13;break}return o.abrupt("return");case 13:r=Object(G["h"])(e,["beforeSubmitValidate","btnLoading","chooseParams","isWorkFlow"]),e.isWorkFlow?null===(i=a.value)||void 0===i||i.startApproval(r,c).then((function(e){var n;t.emit("submit",e,c),null===(n=a.value)||void 0===n||n.resetForm()})):t.emit("submit",r,c);case 15:case"end":return o.stop()}}),o,null,[[0,8]])})));return function(e){return o.apply(this,arguments)}}(),r=function(){t.emit("cancel")},i=Object(H["d"])(),s=i.back,l=Object(o["toRefs"])(e),u=l.authority,b=Object(o["computed"])((function(){return u.value.canEdit||u.value.canChe||u.value.canTui||u.value.canApproval}));return{back:s,handleOk:c,handleCancel:r,approvalRef:a,visible:b}}};n("7ef2");X.render=l,X.__scopeId="data-v-df3a2d14";t["a"]=X},"7ef2":function(e,t,n){"use strict";n("85cc")},"7ff9":function(e,t,n){"use strict";n("b0c0");var o=n("7a23"),a=Object(o["withScopeId"])("data-v-2db1d158"),c=a((function(e,t,n,c,r,i){var s=Object(o["resolveComponent"])("van-field"),l=Object(o["resolveComponent"])("van-picker"),d=Object(o["resolveComponent"])("van-popup");return Object(o["openBlock"])(),Object(o["createBlock"])("div",null,[Object(o["withDirectives"])(Object(o["createVNode"])(s,{name:"procDefKey",modelValue:c.state.key,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.state.key=e})},null,8,["modelValue"]),[[o["vShow"],!1]]),Object(o["createVNode"])(s,{modelValue:c.state.name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.state.name=e}),readonly:"",clickable:"",required:"","is-link":"",name:"name",label:"审批流程",placeholder:"点击选择",onClick:t[3]||(t[3]=function(e){return c.state.isShow=!0}),rules:[{required:!0,message:"请选择"}]},null,8,["modelValue"]),Object(o["createVNode"])(d,{show:c.state.isShow,"onUpdate:show":t[4]||(t[4]=function(e){return c.state.isShow=e}),position:"bottom"},{default:a((function(){return[Object(o["createVNode"])(l,{title:"审批流程","columns-field-names":{text:"name"},columns:n.proList,onConfirm:c.onConfirm,onCancel:c.onCancel,onChange:c.onChange},null,8,["columns","onConfirm","onCancel","onChange"])]})),_:1},8,["show"])])})),r=(n("2934"),{name:"classroomFilter",setup:function(e,t){var n=Object(o["reactive"])({name:"",key:"",isShow:!1}),a=function(e,t){n.name=e.name,n.key=e.key,n.isShow=!1},c=function(e,t){},r=function(){n.isShow=!1},i=function(){n.name="",n.key=""};return{state:n,onChange:c,onCancel:r,onConfirm:a,restData:i}},data:function(){return{xqList:[]}},components:{},created:function(){},computed:{},props:["proList","multiInstance"],watch:{proList:function(e){e&&1==e.length&&(this.state.name=e[0].name,this.state.key=e[0].key)}},methods:{}});r.render=c,r.__scopeId="data-v-2db1d158";t["a"]=r},"85cc":function(e,t,n){},"9c53":function(e,t,n){"use strict";n("1101")},aa70:function(e,t,n){}}]);